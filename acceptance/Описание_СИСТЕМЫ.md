# REST API
## Служебные эндпоинты
- DELETE /api/v1/service/state - очистка стейта
- PUT /api/v1/service/date - установка текущего времени системы. (не реализован)

## API модуля "Биржа"
- GET /api/v1/exchange - получение информации по зарегистрированной бирже,
- GET /api/v1/exchange/instruments/{id} - получение информации по инструменту по его идентификатору,
- GET /api/v1/exchange/instruments - получение списка инструментов,
- GET /api/v1/exchange/instruments/{id}/statistic - получение статистики инструмента по его идентификатору,
- POST /api/v1/instruments/integrate - интеграция данных по инструментам,
- POST /api/v1/instruments/daily-integrate - интеграция торговых данных,
- PATCH /api/v1/instruments/enable-update - включение обновления торговых данных инструментов,
- PATCH /api/v1/instruments/disable-update - выключение обновления торговых данных инструментов.

## API модуля "Сканер сигналов"
- GET /api/v1/signal-scanner - получение списка сканеров сигналов,
- GET /api/v1/signal-scanner/{id} - получение сканера сигнала по его идентификатору,
- POST /api/v1/signal-scanner - создание нового сканера сигналов.
- PATCH /api/v1/signal-scanner - обновление информации сканера сигналов (описание и список инструментов).
- POST /api/v1/signal-scanner/run - запуск сканиров сигналов.

## API модуля "Расписание"
- GET /api/v1/schedule - получение текущего расписания,
- GET /api/v1/system-modules - получение списка текущих модулей,
- POST /api/v1/schedule - создание нового расписания,
- DELETE /api/v1/schedule - удаление текущего расписания.

# Приемочные тестовые сценарии
## Модуль "Биржа"

### T1. Синхронизация с источником биржевых данных.
#### Начальное состояние системы
Постоянное хранилище системы пустое, нет инициализированного кэша.
#### Действие над системой
Запускается синхронизация с источником биржевых данных.
#### Результирующее состояние системы
В системе зарегистрирован источник биржевых данных, в систему добавлены финансовые инструменты из источника биржевых данных.

### T2. Повторная синхронизация с источником биржевых данных.
#### Начальное состояние системы
В системе зарегистрирован источник биржевых данных, в систему добавлены финансовые инструменты из источника биржевых данных.
#### Действие над системой
Запускается синхронизация с источником биржевых данных.
#### Результирующее состояние системы
Обновлены данные по финансовым инструментам из источника биржевых данных. Дубли не созданы.

### T3. Поиск финансовых инструментов по тикеру.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы


### T4. Поиск финансовых инструментов по типу.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T5. Поиск финансовых инструментов по названию.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T6. Получение детализированной информации по финансовому инструменту.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T6. Включение обновления торговых данных по финансовым инструментам.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T7. Выключение обновления торговых данных по финансовому инструменту.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T8. Обновление торговых данных по финансовому инструменту.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T9. Получение аналитических расчетов по финансовому инструменту.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы

### T10. Архивация и очистка торговых данных по финансовому инструменту.
#### Начальное состояние системы

#### Действие над системой

#### Результирующее состояние системы



# Тест-кейсы уровня "Приложение"
## Модуль "Биржа"

T1. Источник биржевых данных не зарегистрирован, хранилище финансовых инструментов пустое.
Запускается синхронизация с источником биржевых данных.
Дублей по тикерам в данных нет, все записи валидны.
Данные представлены по двум инструментам - IMOEX, AFKS.
Результат: зарегистрирована биржа, сохранены 2 инструмента.

T2. Повторная синхронизация с источником биржевых данных.
Количество инструментов при первой синхронизации - 10, при второй - те же 10.
Результат: в системе зарегистрирвана одна биржа, количество сохраненных инструментов 10.

T3. Повторная синхронизация с источником биржевых данных.
Количество инструментов при первой синхронизации - 3, при второй - 6.
Результат: в системе зарегистрирована одна биржа, количество сохраненных инструментов 6.

T4. Источник биржевых данных не зарегистрирован, хранилище финансовых инструментов пустое.
Запускается синхронизация с источником биржевых данных.
Есть дубли по тикерам, все записи валидны.
Результат: зарегистрирована биржа, в хранилище инструментов нет дубликатов.

T5. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена интеграция торговых данных по инструменту AFKS.
Все данные источника валидны, дублирующих записей нет.
Результат: сохранены текущие сделки и история торгов.

T6. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена внутридневная интеграция по несуществующему в хранилище инструменту.
Результат: ошибка, текст ошибки: "Инструмент с идентификатором <id> не найден."

T7. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена внутридневная интеграция по пустому списку инструментов.
Результат: ошибка, текст ошибки "Не переданы идентификаторы для интеграции торговых данных."

T8. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена внутридневная интеграция, в качестве идентификатора для обновления торговых данных передан null.
Результат: ошибка, текст ошибки: "Не переданы идентификаторы для интеграции торговых данных."

T9. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена интеграция торговых данных инструмента AFKS.
Текущая дата 2023-12-19T10:00:00, неторговый день, сделок нет.
Результат: Загружены данные итогов торгов.

T10. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена интеграция торговых данных инструмента AFKS.
В данных по сделкам есть дублирующие записи.
Результат: дубликаты не сохранены, остальные сделки успешно сохранены.

T11. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
Запущена интеграция торговых данных инструмента AFKS.
В исходных данных по сделкам есть данные за предыдущий день.
Результат: сохранены только сделки за текущий день.

T12. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
По инструменту AFKS сохранены сделки до 2023-12-07T12:00:00.
Текущее время 2023-12-07T13:00:00. Запущена интеграция торговых данных по инструменту AFKS.
Результат: сохранены только новые сделки, прошедшие после 12:00:00.

T13. Источник биржевых данных зарегистрирован, хранилище финансовых инструментов не пустое.
По инструменту AFKS сохранены итоги торгов по 2023-12-07.
Текущее время 2023-12-09T13:00:00. Запущена интеграция торговых данных по инструменту AFKS.
Результат: добавлена история торгов за 2023-12-08.

T14. Хранилище финансовых инструментов не пустое.
Сохранены торговые данные только по акции AFKS.
Запрошена статистика по инструментам.
Результат: статистика успешно расчитана только для акции AFKS.

T15. Хранилище финансовых инструментов не пустое.
Сохранены торговые данные только по фьючерсу BRF4.
Запрошена статистика по инструментам.
Результат: статистика успешно расчитана только для фьючерса BRF4. Значений по средневзвешенной цене нет.

T16. Хранилище финансовых инструментов не пустое.
Сохранены торговые данные только по валютной паре USD000UTSTOM.
Запрошена статистика по инструментам.
Результат: статистика успешно расчитана только для валютной пары USD000UTSTOM.

T17. Хранилище финансовых инструментов не пустое.
Сохранены торговые данные только по индексу фондового рынка IMOEX.
Запрошена статистика по инструментам.
Результат: статистика успешно расчитана только для индекса фондового рынка IMOEX. Значений по средневзвешенной цене нет.

T18. Хранилище финансовых инструментов не пустое.
Торговых данных нет.
Запрошена статистика по инструментам.
Результат: нет статистических данных.

T19. Хранилище финансовых инструментов не пустое.
Сохранена только история торгов по инструменту AFKS.
Запрошена статистика по инструментам.
Результат: нет статистических данных.

T20. Хранилище финансовых инструментов не пустое.
Сохранены только данные по текущим торгам.
Запрошена статистика по инструментам.
Результат: нет статистических данных.

## Модуль "Сканер сигналов"

T1. Регистрация нового сканера сигналов для финансового инструмента с идентификатором AFKS.
Инструмент интегрирован в систему. Дневные сделки и исторические данные не загружены.

T2. Регистрация нового сканера сигналов без финансовых инструментов.

T3. Регистрация нового сканера сигналов с пустым списком финансовых инструментов.

T4. Регистрация нового сканера сигналов со списком из нескольких финансовых инструментов.

T5. Регистрация нового сканера сигналов без алгоритма поиска и со списком из нескольких финансовых инструментов.

T6. В конфигурацию AnomalyVolumeSignalConfig не передан параметр scaleCoefficient.
Результат: ошибка, текст ошибки: "Не передан параметр scaleCoefficient."

T7. В конфигурацию AnomalyVolumeSignalConfig не передан параметр historyPeriod.
Результат: ошибка, текст ошибки: "Не передан параметр historyPeriod."

T8. В конфигурацию AnomalyVolumeSignalConfig не передан параметр indexTicker.
Результат: ошибка, текст ошибки: "Не передан параметр indexTicker."

T9. В конфигурацию AnomalyVolumeSignalConfig параметр indexTicker передан как пустая строка.
Результат: ошибка, текст ошибки: "Не передан параметр indexTicker."

T10. В конфигурацию AnomalyVolumeSignalConfig параметр scaleCoefficient передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр scaleCoefficient должен быть больше нуля."

T11. В конфигурацию AnomalyVolumeSignalConfig параметр scaleCoefficient передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр scaleCoefficient должен быть больше нуля."

T12. В конфигурацию AnomalyVolumeSignalConfig параметр historyPeriod передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр historyPeriod должен быть больше нуля."

T13. В конфигурацию AnomalyVolumeSignalConfig параметр historyPeriod передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр historyPeriod должен быть больше нуля."

Т14. Создан сканер сигналов AnomalyVolumeScannerSignal для двух инструментов.
По обоим инструментам есть торговые данные. По обоим инструментам объемы превышают средневзвешенные больше, чем
в scaleCoefficient-раз.
Результат: зарегистрировано два сигнала.

T15. В конфигурацию CorrelationSectoralSignalConfig не передан параметр futuresOvernightScale.
Результат: ошибка, текст ошибки: "Не передан параметр futuresOvernightScale."

T16. В конфигурацию CorrelationSectoralSignalConfig не передан параметр stockOvernightScale.
Результат: ошибка, текст ошибки: "Не передан параметр stockOvernightScale."

T17. В конфигурацию CorrelationSectoralSignalConfig не передан параметр futuresTicker.
Результат: ошибка, текст ошибки: "Не передан параметр futuresTicker."

T18. В конфигурацию CorrelationSectoralSignalConfig параметр futuresTicker передан как пустая строка.
Результат: ошибка, текст ошибки: "Не передан параметр futuresTicker."

T19. В конфигурацию CorrelationSectoralSignalConfig параметр futuresOvernightScale передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр futuresOvernightScale должен быть больше нуля."

T20. В конфигурацию CorrelationSectoralSignalConfig параметр futuresOvernightScale передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр futuresOvernightScale должен быть больше нуля."

T21. В конфигурацию CorrelationSectoralSignalConfig параметр stockOvernightScale передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр stockOvernightScale должен быть больше нуля."

T22. В конфигурацию CorrelationSectoralSignalConfig параметр stockOvernightScale передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр stockOvernightScale должен быть больше нуля."

T23. TATN росла вчера, BRF4 рос вчера.
Сигнал зафиксирован.

T24. TATN росла вчера, BRF4 падал вчера.
Сигнал не зафиксирован.

T25. В конфигурацию SectoralRetardSignalConfig не передан параметр historyScale.
Результат: ошибка, текст ошибки: "Не передан параметр historyScale."

T26. В конфигурацию SectoralRetardSignalConfig параметр historyScale передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр historyScale должен быть больше нуля."

T27. В конфигурацию SectoralRetardSignalConfig параметр historyScale передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр historyScale должен быть больше нуля."

T28. В конфигурацию SectoralRetardSignalConfig не передан параметр intradayScale.
Результат: ошибка, текст ошибки: "Не передан параметр intradayScale."

T29. В конфигурацию SectoralRetardSignalConfig параметр intradayScale передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр intradayScale должен быть больше нуля."

T30. В конфигурацию SectoralRetardSignalConfig параметр intradayScale передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр intradayScale должен быть больше нуля."

T31. ROSN, LKOH, SIBN, TATN - сектор нефти.
3 из 4 позиций не росли в последние дни, сигнала нет.

T32. ROSN, LKOH, SIBN росли в предыдущий день, растут сегодня.
TATN росла вчера, сегодня падает.

T33. В конфигурацию PrefSimpleSignalConfig не передан параметр spreadParam.
Результат: ошибка, текст ошибки: "Не передан параметр spreadParam."

T34. В конфигурацию PrefSimpleSignalConfig параметр spreadParam передан со значением = 0.
Результат: ошибка, текст ошибки: "Параметр spreadParam должен быть больше нуля."

T35. В конфигурацию PrefSimpleSignalConfig параметр spreadParam передан со значением < 0.
Результат: ошибка, текст ошибки: "Параметр spreadParam должен быть больше нуля."

T36. В текущих сделках Сбер и СберП разница между ценой последних сделок больше чем расчетный исторический показатель.
Сигнал есть.

T37. В текущих сделках Сбер и СберП разница между ценой последних сделок меньше чем расчетный исторический показатель.
Сигналов нет.

## Модуль "Расписание"

Текущий функционал:
1) Редактирование расписания
2) Добавление отслеживаемых объектов в юнит расписания
3) Получение списка доступных к управлению модулей
4) Получение текущего расписания